#!/usr/bin/env python
# -*- coding: utf-8 -*-

import os
import sys
import tempfile
from optparse import make_option

import django
from django.core.management.templates import TemplateCommand
from django.core.management import call_command

class Command(TemplateCommand):
    help = ("Creates a Cyclope Demo project.")

    def handle(self, project_name="demo", target=None, *args, **options):

        val = os.system("cyclopeproject -v0 " + (project_name or ""))
        if val:
            return

        #os.chdir(project_name)
        sys.path.insert(0, ".")
        os.environ.setdefault("DJANGO_SETTINGS_MODULE", project_name +".settings")
        call_command("creardb", demo=True)

if __name__ == "__main__":
    cmnd = Command()
    if len(sys.argv) == 1:
        cmnd.print_help("startcyclopeproject", "")
    else:
        sys.argv.insert(0, "") # Hack run_from_argv
        cmnd.run_from_argv(sys.argv)
