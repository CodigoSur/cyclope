{% extends host_template %}

{% comment%}
TODO(nicoechaniz): finish adaptation from smarty to django. add trans to text that should be translated
{% endcomment%}

{% load comments i18n fb_versions cyclope_utils markup dbgettext_tags%}

{% block content %}

{% alias contact as 'current_object' %}

<div class="content-view contact detail contact-detail">

  {% get_comment_count for contact as comment_count %}

  <div class="meta-content">{% include 'collections/categories_navigation_block.html' %}</div>

  {% if contact.pretitle %}
  <div class="pretitle-container meta-content"><span class="pretitle">{{ contact.pretitle }}</span></div>
  {% endif %}
  <h1 class="title">{% trans contact.name  %}</h1>

  <!-- herramientas -->
  <div class="tools meta-content">
    <ul>
      <li class="first"><a href="javascript:window.print()" class="print">{% trans "Print" %}</a></li>
      <li>
        <a href="/share?slug={{ contact.slug }}" onclick="abrir_popup(this);return false" class="share">
          {% trans "Share" %}
        </a>
      </li>

      {% if not contact.allow_comments == 'NO' %}
        {% if comment_count %}
        <li>
          <a href="#comments" class="comments_link">{% trans "Comments" %} ({{ comment_count }})</a>
        </li>
        {% endif %}
      {% endif %}
    </ul>
  </div>
  <!-- /herramientas -->

  <!-- descripcion -->
  {% if contact.summary %}
  <p class="summary">{{ contact.summary|safe }}</p>
  {% endif%}
  <!-- /descripcion -->

  {% if contact.pictures %}
  <div id="gallery" class="media-content">
    <ul>
      {% for picture in contact.pictures %}
      <li {% if not forloop.first %} style="display:none;" {% endif %} >
        <a href="{% version picture.image.path 'medium' %}"  title="{{ picture.name }}">
          <img src="{% version picture.image.path 'small' %}" alt="{{ picture.name }}" />
        </a>
        <p>{{ picture.name }}</p>
      </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}


  <!-- author -->
  {% if contact.author %}
  <div id="author" class="meta-content">
    {% if contact.author.image %}
    <img src="" width="60"  />
    {% endif %}
    <span class="author">{% trans "By"%} {{ contact.author }}</span>
  </div>
  {% endif %}
  <!-- /autor -->

    <!-- descargas -->

<!-- TODO(nicoechaniz): uncomment and fix when attachments are implemented

            {if $articulo.downloads eq 'si'}

          <div id="attachments">
          <div class="attachments_box">
            <h6><img src="{$templatedir}{{ CYCLOPE_THEME_MEDIA_URL }}images/css/leer_adjuntos.png" alt="Adjuntos"  width="16" height="16" border="0" align="absmiddle" /> Archivos para descargar </h6>
             {section name=bucle loop=$downloads}
            <p><img src="http://codigosur.org/imagenes/icons/{$downloads[bucle].ext}.gif" width="20" height="22" border="0" align="middle"> <a href="{$downloads[bucle].link}" title="{$downloads[bucle].desc}" >{$downloads[bucle].nombre}</a></p>
            {/section}
           </div>
          </div>

          {/if}
-->
          <!-- /descargas -->

  <div><span class="html-text html-content">00
    {% if CYCLOPE_contact_TEXT_STYLE == 'raw' or CYCLOPE_contact_TEXT_STYLE == 'wysiwyg'%}
      {{ contact|parsed_gettext:"text"|safe }}aa
    {% else %}
        {% if CYCLOPE_contact_TEXT_STYLE == 'textile' %}
        {{ contact.text|textile }}bb
        {% else %}
          {% if CYCLOPE_contact_TEXT_STYLE == 'markdown'%}
          {{ contact.text|markdown }}cc
          {% endif %}
        {% endif %}
    {% endif %}
  </span></div>

  <div class="meta-content"><span class="source">--<br>
    {% trans "Date" %}: {{ contact.date|date:'SHORT_DATE_FORMAT' }}{% if contact.source %} |
    {% trans "Source" %}: {contact.source}{% endif %}
  </span></div>

  {% if contact.tags %}
    <div class="meta-content"><span class="tags"><span class="tags-label">{% trans "Tags" %}:</span> {{ contact.tags }}</span></div>
  {% endif %}

</div>

{% endblock content%}
